var _=Object.defineProperty;var P=I=>{throw TypeError(I)};var ii=(I,i,n)=>i in I?_(I,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):I[i]=n;var C=(I,i,n)=>ii(I,typeof i!="symbol"?i+"":i,n),R=(I,i,n)=>i.has(I)||P("Cannot "+n);var M=(I,i,n)=>(R(I,i,"read from private field"),n?n.call(I):i.get(I)),B=(I,i,n)=>i.has(I)?P("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(I):i.set(I,n),H=(I,i,n,e)=>(R(I,i,"write to private field"),e?e.call(I,n):i.set(I,n),n);(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))e(s);new MutationObserver(s=>{for(const t of s)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&e(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const t={};return s.integrity&&(t.integrity=s.integrity),s.referrerPolicy&&(t.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?t.credentials="include":s.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function e(s){if(s.ep)return;s.ep=!0;const t=n(s);fetch(s.href,t)}})();const y={blockSize:100};class E{constructor(i,n,e,s){C(this,"WIDTH",y.blockSize);this.x=i,this.y=n,this.length=e,this.type=s}isAt(i,n){return this.type==="x"?this.x<i&&i<this.x+this.length&&this.y<n&&n<this.y+this.WIDTH:this.x<i&&i<this.x+this.WIDTH&&this.y<n&&n<this.y+this.length}intersectsWith(i){return this.intersectsWithRect(i.x,i.y,i.rectWidth,i.rectHeight)}intersectsWithCorners(i,n){return!!n.some(e=>i.isAt(e.x,e.y))}intersectsWithRect(i,n,e,s){const t=i+e,o=n+s,O=this.x+this.rectWidth,l=this.y+this.rectHeight;return this.x<t&&O>i&&this.y<o&&l>n}doesLegalMoveIntersect(i,n){const s=Math.min(i.x,this.x)+20,t=Math.min(i.y,this.y)+20,o=Math.abs(this.x-i.x)+this.rectWidth-20,O=Math.abs(this.y-i.y)+this.rectHeight-20;return n.some(l=>l.intersectsWithRect(s,t,o,O))}get rectWidth(){return this.type==="x"?this.length:this.WIDTH}get rectHeight(){return this.type==="x"?this.WIDTH:this.length}minified(i){const n=this.WIDTH,e=this.x/n,s=this.y/n,t=this.length/n,O={c:Object.keys(i).find(m=>i[m]===this.constructor),x:e,y:s,l:t,t:this.type},l=["WIDTH","x","y","length","type"];if(Object.keys(this).filter(m=>!l.includes(m)).length>0){const m={};m.forEach(g=>m[g]=this[g]),O.e=m}return O}static fromMinified(i,n){const e=y.blockSize,s=n[i.c],t=new s(i.x,i.y,i.l,i.t);if(t.x=i.x*e,t.y=i.y*e,t.length=i.l*e,t.type=i.t,i.e){const o=i.e;Object.keys(o).forEach(l=>t[l]=o[l])}return t}drawRect(i){throw new Error("override this implementation")}draw(i){i.save(),i.translate(this.x+(this.type==="x"?0:this.WIDTH),this.y);const n=this.type==="x"?0:Math.PI/2;i.rotate(n),this.drawRect(i),i.restore()}}class b extends E{drawRect(i){i.beginPath(),i.lineWidth=2,i.rect(1,1,this.length-2,this.WIDTH-2),i.stroke();const t=i.filter;i.filter="brightness(70%) opacity(0.5)",i.beginPath(),i.rect(1,1,this.length-2,this.WIDTH-2),i.fill(),i.filter=t,i.beginPath();const o=this.length-2*15;i.roundRect(15,10,o,this.WIDTH-10*2,10);const O=0,l=this.WIDTH/2-15/2;i.rect(O,l,15,15),i.rect(O+this.length-15,l,15,15),i.fill()}}class Y extends E{constructor(i,n){super(i,n,2*y.blockSize,"x")}copy(){return new Y(this.x,this.y)}drawRect(i){const n=y.blockSize/10,e=y.blockSize/3,s=y.blockSize/2,t=i.lineWidth;i.lineWidth=n,i.lineCap="round",i.strokeStyle="yellow",i.beginPath(),i.arc(s,s,e,0,Math.PI*2),i.moveTo(s+e,s),i.lineTo(y.blockSize*2,s),i.stroke(),i.beginPath(),i.fillStyle="yellow";const o=3,O=y.blockSize/4;i.moveTo(y.blockSize*2,s),i.lineTo(y.blockSize*2,s);for(let l=0;l<o;l++){const f=y.blockSize*2-O*l;i.lineTo(f-O,s-O),i.lineTo(f-O,s)}i.lineTo(y.blockSize*2-O*o,s),i.fill(),i.lineWidth=t}}function Ii(I){var i=document.createElement("textarea");i.value=I,i.style.top="0",i.style.left="0",i.style.position="fixed",document.body.appendChild(i),i.focus(),i.select();try{var n=document.execCommand("copy"),e=n?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+e)}catch(s){console.error("Fallback: Oops, unable to copy",s)}document.body.removeChild(i)}function si(I){if(!navigator.clipboard){Ii(I);return}navigator.clipboard.writeText(I).then(function(){console.log("Async: Copying to clipboard was successful!")},function(i){console.error("Async: Could not copy text: ",i)})}const G={c:b,k:Y,r:E},p=["eyJvYmpzIjpbeyJjIjoiayIsIngiOjIsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjEsInkiOjAsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjEsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjQsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjUsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjIsInkiOjMsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjMsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjUsImwiOjIsInQiOiJ4In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjAsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjEsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjEsInkiOjMsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjIsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjIsInkiOjUsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjMsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjEsImwiOjIsInQiOiJ5In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjIsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjEsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjMsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjQsImwiOjIsInQiOiJ4In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjAsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjEsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjIsInkiOjEsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjIsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjMsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjMsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjUsInkiOjMsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjQsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjQsImwiOjIsInQiOiJ5In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjIsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjEsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjIsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjQsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjUsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjMsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjAsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjEsImwiOjIsInQiOiJ5In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjEsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjEsInkiOjEsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjEsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjMsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjQsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjUsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjMsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjMsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjIsImwiOjIsInQiOiJ5In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjAsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjEsInkiOjAsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjIsInkiOjMsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjUsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjQsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjEsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjMsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjAsImwiOjIsInQiOiJ5In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjIsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjAsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjIsInkiOjEsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjEsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjMsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjQsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjUsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjMsImwiOjIsInQiOiJ4In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjAsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjEsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjEsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjMsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjIsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjQsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjUsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjQsImwiOjIsInQiOiJ4In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjAsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjEsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjUsInkiOjEsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjMsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjIsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjQsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjUsImwiOjMsInQiOiJ4In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjIsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjEsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjMsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjMsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjMsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjMsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjIsInkiOjUsImwiOjMsInQiOiJ4In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjAsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjMsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjQsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjIsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjAsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjIsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjEsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjAsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjMsInkiOjMsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjUsInkiOjIsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjUsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjQsImwiOjIsInQiOiJ5In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjEsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjAsInkiOjIsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjMsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjIsInkiOjMsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjUsInkiOjIsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjEsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjAsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjEsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjUsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjQsImwiOjIsInQiOiJ4In1dfQ%3D%3D","eyJvYmpzIjpbeyJjIjoiayIsIngiOjIsInkiOjIsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjIsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjUsInkiOjEsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjIsInkiOjEsImwiOjMsInQiOiJ4In0seyJjIjoiYyIsIngiOjIsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjQsInkiOjAsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjEsInkiOjAsImwiOjMsInQiOiJ5In0seyJjIjoiYyIsIngiOjAsInkiOjMsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjEsInkiOjMsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjEsInkiOjUsImwiOjIsInQiOiJ4In0seyJjIjoiYyIsIngiOjMsInkiOjQsImwiOjIsInQiOiJ5In0seyJjIjoiYyIsIngiOjQsInkiOjQsImwiOjIsInQiOiJ4In1dfQ%3D%3D"],h=document.getElementById("game"),c=h.getContext("2d"),ni=document.getElementById("rotate-btn"),ei=document.getElementById("delete-btn"),z=document.getElementById("candle-size-input"),ti=document.getElementById("main-play-button"),N=document.getElementById("edit-tools-container"),ji=document.getElementById("common-tools-container"),oi=document.getElementById("tools"),D=document.getElementById("main-menu"),q=document.getElementById("main-menu-items"),x=document.getElementById("view-all-items"),Oi=document.getElementById("current-state");let K=!1;var u;class yi{constructor(){B(this,u,"edit")}get mode(){return M(this,u)}set mode(i){Oi.innerText=i+"ing",H(this,u,i)}get isEditMode(){return M(this,u)==="edit"}get isPlayMode(){return M(this,u)==="play"}}u=new WeakMap;const d=new yi,$=[ni,z,ei];function ci(){const{width:I,height:i}=h.getBoundingClientRect();return Math.min(I,i)}const T=ci(),k=T,w=T;let j=null,a=null;console.log(`Setting canvas size ${k}, ${w}`);h.width=k;h.height=w;h.style.width=`${k}px`;h.style.height=`${w}px`;oi.style.width=`${k}px`;const v={w:6,h:6};y.blockSize=T/v.w;let Q=new Y(0,w/2-1),J=[Q];U();function U(){const i=new URLSearchParams(window.location.search).get("g");if(i)try{console.log("loading"),console.log(i),li(decodeURIComponent(i)),ti.innerText="Start game"}catch(n){console.error("Attempted to load game from URL but failed."),console.error(n)}}function li(I){const i=JSON.parse(atob(I)),n=[];for(const s of i.objs){const t=E.fromMinified(s,G);n.push(t)}const e=n.find(s=>s instanceof Y);e?Q=e:n.push(Q),J=n,K=!0}const ri=()=>J.filter(I=>I instanceof b);function W(){j=null,$.forEach(I=>{I.classList.add("hidden")})}function ai(I){j=I,$.forEach(i=>{i.classList.remove("hidden")}),z.value=String(Math.floor(j.length/y.blockSize))}function Ji(){j&&(j.type=j.type==="x"?"y":"x")}function mi(){j&&(j.length=(Number(z.value)||1)*y.blockSize)}function di(){if(j instanceof b){const I=J.findIndex(i=>i===j);I>=0&&(J.splice(I,1),W())}}function gi(I,i,n,e,s){const t=Math.floor(I/y.blockSize),o=Math.floor(i/y.blockSize);I=t*y.blockSize,i=o*y.blockSize;const O=new b(I,i,n,"x");if(!O.intersectsWith(s)&&!e.some(l=>l.intersectsWith(O)))return O}function A(I,i=null){const{x:n,y:e}=I,s=t=>Math.floor(t/y.blockSize)*y.blockSize;return i?{...I,[i.type]:s(i.value)}:{x:s(n),y:s(e)}}const r={isDown:!1,position:{x:0,y:0},dragStartSelectedState:null};function hi(){const I=e=>{const{offsetX:s,offsetY:t}=e;r.position.x=s,r.position.y=t,r.isDown=!0;const o=J.find(O=>O.isAt(s,t));if(o){ai(o),r.dragStartSelectedState={offsetWithSelected:{x:s-o.x,y:t-o.y},position:{x:s,y:t}};return}else if(!j){if(!d.isEditMode)return;const O=gi(s,t,y.blockSize,ri(),Q);if(!O)throw new Error("no place to make a candle");J.push(O)}W()},i=e=>{r.isDown=!1;const{offsetX:s,offsetY:t}=e;if(r.position.x=s,r.position.y=t,j&&r.dragStartSelectedState)if(d.isEditMode)if(a)j.x=a.x,j.y=a.y,j=a=null;else{const{x:o,y:O}=A({x:r.dragStartSelectedState.position.x,y:r.dragStartSelectedState.position.y});j.x=o,j.y=O}else{const{x:o,y:O}=A({x:j.x+y.blockSize/2,y:j.y+y.blockSize/2});j.x=o,j.y=O}},n=e=>{const{offsetX:s,offsetY:t}=e;if(r.position.x=s,r.position.y=t,r.isDown&&j&&r.dragStartSelectedState){const o=d.isEditMode?void 0:j.type==="x"?"y":"x",{x:O,y:l}=A(r.position,o?{type:o,value:j[o]}:null),f={x:j.x,y:j.y};if(o!=="x"&&(j.x=s-r.dragStartSelectedState.offsetWithSelected.x),o!=="y"&&(j.y=t-r.dragStartSelectedState.offsetWithSelected.y),d.isPlayMode&&(j.x<0||j.y<0||j.x+j.rectWidth>k||j.y+j.rectHeight>w||j.doesLegalMoveIntersect(f,J.filter(g=>g!==j)))&&(j.x=f.x,j.y=f.y),!d.isEditMode)return;const m=new b(O,l,j.length,j.type);J.filter(g=>g!==j).some(g=>j instanceof Y&&g.intersectsWithRect(k-y.blockSize,Q.y,y.blockSize,y.blockSize)?!0:g.intersectsWith(m))?a=null:(a||(a=m),a.x=O,a.y=l)}};h.addEventListener("pointerdown",I),h.addEventListener("pointerup",i),h.addEventListener("pointermove",n)}function F(){c.fillStyle="black",c.fillRect(0,0,k,w),c.strokeStyle="lightgrey";for(let e=1;e<v.w;e++){const s=e*y.blockSize,t=0,o=w;c.beginPath(),c.moveTo(s,t),c.lineTo(s,o),c.stroke()}for(let e=1;e<v.h;e++){const s=e*y.blockSize,t=0,o=w;c.beginPath(),c.moveTo(t,s),c.lineTo(o,s),c.stroke()}a&&r.isDown&&(c.fillStyle="lightgreen",a.draw(c)),J.forEach(e=>{e.type==="x"?(c.fillStyle="limegreen",c.strokeStyle="limegreen"):(c.strokeStyle="red",c.fillStyle="red"),e.draw(c)}),d.isEditMode&&j&&(c.fillStyle="blue",j.draw(c)),Q.draw(c),c.fillStyle="white";const I=30;c.beginPath();const i="WIN";c.font=`${I}px Arial`,c.textBaseline="middle";const n=c.measureText(i);c.fillText("WIN",k-(y.blockSize+n.width)/2,Q.y+(I+y.blockSize)/2),c.fill(),requestAnimationFrame(F)}hi();requestAnimationFrame(F);function X(){D.classList.add("hidden"),ji.classList.remove("hidden")}function V(){d.mode="edit";const I=new URL(window.location.href);I.searchParams.delete("g"),history.pushState(null,"",I),N.classList.remove("hidden"),D.classList.contains("hidden")||X(),j=null}function Z(){const i={objs:J.map(s=>s.minified(G))},n=JSON.stringify(i);return encodeURIComponent(btoa(n))}function S(){const I=Z(),i=new URL(window.location.href);i.searchParams.set("g",I),history.pushState(null,"",i),ui()}function wi(){K||L(p[p.length-1]),S()}function L(I){const i=decodeURIComponent(I),n=new URL(window.location.href);n.searchParams.set("g",i),history.pushState(null,"",n),U()}function Qi(){const I=Math.floor(Math.random()*p.length),i=p[I];L(i),S()}function ki(){q.classList.add("hidden"),x.classList.remove("hidden")}function fi(){const I=document.createElement("button");I.addEventListener("click",()=>{q.classList.remove("hidden"),x.classList.add("hidden")}),I.innerText="Back to menu";const i=[I];p.forEach((n,e)=>{const s=document.createElement("button");s.addEventListener("click",()=>{L(n),S()}),s.innerText=`Preset ${e+1}`,i.push(s)}),i.forEach(n=>x.appendChild(n))}fi();function ui(){d.mode="play",D.classList.contains("hidden")||X(),N.classList.add("hidden"),j=null}function Yi(){d.isEditMode?S():V()}function pi(){d.isEditMode?(Q=new Y(0,w/2-2),J=[Q]):(U(),W())}function bi(){const I=Z(),i=new URL(window.location.href);i.searchParams.set("g",I),console.log("Copied game to clipboard: ",i.href),si(i.href)}const Mi=`
<h5>Description</h5>
This puzzle game's main objective is to get the key out of a maze 
by moving around the walls where the key and walls can only move in specific directions.

<h5>Credits</h5>
It's created with pure JS by <a href="https://github.com/maheshbansod">Light</a> a.k.a. <a href="https://maheshbansod.com">Mahesh Bansod</a>.<br/>
Source code for this is probably available on <a href="https://github.com/maheshbansod">my github</a>. <br />
`;function Ei(I){Object.keys(I).forEach(i=>window[i]=I[i])}Ei({aboutTheGame:Mi,copyGameLink:bi,playTodaysGame:wi,playRandomGame:Qi,viewAll:ki,rotateSelectedObject:Ji,changeCandleSize:mi,deleteSelectedObject:di,switchToEditor:V,clearReset:pi,togglePlayEdit:Yi});
